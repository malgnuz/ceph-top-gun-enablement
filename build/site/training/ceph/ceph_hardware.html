<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hardware recommendations :: Ceph Top Gun Enablement</title>
    <link rel="canonical" href="https://likid0.github.io/ceph-top-gun-enablement/training/ceph/ceph_hardware.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.ceph.com/en/latest/" target="_blank">
          <img src="../../_/img/header_logo_reverse.svg" height="48px" alt="Ceph">
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Get Help</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://access.redhat.com/documentation/zh-cn/red_hat_ceph_storage/5" target="_blank">Ceph Documentation</a>
            <a class="navbar-item" href="https://bugzilla.redhat.com/describecomponents.cgi?product=Red%20Hat%20OpenShift%20Container%20Storage" target="_blank">Browse Bugs</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Improve Guides</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/likid0/ceph-top-gun-enablement/issues/new/choose" target="_blank">Open Issue</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Infos</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://www.redhat.com/en/blog/channel/red-hat-storage" target="_blank">Our Blog</a>
            <a class="navbar-item" href="https://www.youtube.com/channel/UCoyG8VyvB-XUxQl1mD3T3Gw" target="_blank">Youtube</a>
            <a class="navbar-item" href="https://docs.ceph.com/en/latest/" target="_blank">Ceph Storage Technology</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="training" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Ceph Top-Gun Enablement</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph Lab Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="opentlc_lab_env.html">Opentlc Lab Env</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Core Ceph</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_introduction.html">Ceph Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_architecture.html">Ceph Architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cluster_partitioning.html">Ceph Cluster Partitioning</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="ceph_hardware.html">Ceph Hardware Recommendations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_deployment_intro.html">Ceph Install Methods </a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cephadm_intro.html">Cephadm Orchestrator</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_deploy_basic.html">Deploy Ceph with Cephadm</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_deploy_ui.html">Deploy Ceph from the UI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_dashboard_metrics.html">Ceph Dashboard Management &amp; Metrics</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cli_intro.html">Ceph CLI basic commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_configuration.html">Ceph Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_pools.html">Ceph storage pools config</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_pgs.html">Ceph Health and PGs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_bluestore.html">Ceph OSD Bluestore</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_recovery.html">Ceph OSD Failure/Recovery</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cephx.html">Rados CephX Auth/AuthZ</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_version.html">What version of Ceph am I running?</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph-upgrades_cephadm.html">Upgrade Ceph with Cephadm</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_deployment_challenge.html">Challenge Ceph Deployment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph RADOS Block Device</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephrbd_intro.html">RADOS Block Device introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephrbd_export.html">RBD Import/Export</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephrbd_mirroring.html">RBD Mirroring</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephrbd_challenge.html">Challenge RBD</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">CephFS Shared FileSystem</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephfs_intro.html">CephFS introduction &amp; Deployment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephfs_advanced.html">CephFS Deep Dive</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cephfs_challenge.html">Challenge Cephfs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph RadosGW</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_intro.html">RGW Introduction &amp; Deployment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_arch_deep_dive.html">RGW Deep Dive</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_ha.html">RGW High Availability</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_ssl.html">RGW &amp; Ingress with SSL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_users_quotas.html">RGW Users &amp; Quotas</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_auth.html">RGW Auth &amp; Authz</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_object_versioning.html">RGW S3 Object Versioning</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_placement_and_storage_classes.html">RGW Placement &amp; Storage Classes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_life_cycle_management.html">RGW Life Cycle Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_bucket_policy.html">RGW S3 Bucket Policy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_sts_introduction.html">RGW Secure Token Service</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_sts_bucket_role_policy.html">RGW Bucket vs Role Policy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_multisite.html">RGW Multisite Replication</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_cloudsync.html">RGW Object Cloud Transition</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_archive.html">RGW Archive Zone</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_presignedurl.html">RGW presigned URL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_opslog.html">RGW Opslog</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_bucket_notification.html">RGW bucket Notification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_rgw_challenge.html">Challenge RGW</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="troubleshooting_logging.html">Troubleshooting Logs Debug Mode</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="trouble-shooting-nearfull-osds.html">Troubleshooting nearfull OSDs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="troubleshooting_bluestore.html">Troubleshooting Bluestore issues</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="trouble-shooting-large-omap-objects.html">Troubleshooting Large Omap Objects</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="troubleshooting_break_and_fix.html">Troubleshooting Break &amp; Fix Hands-on</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph Benchmarking</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_performance_example.html">Setting the Inital Baseline</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_performance_fio.html">Benchmarking Ceph block and File</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_performance_object.html">Benchmarking Ceph Object(RGW)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph Stretched</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="rhcs-stretched-deploy.html">Ceph Stretch Mode</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph Challenge Solutions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_deployment_challenge_solution.html">Ceph Deployment Solution</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephrbd_challenge_solution.html">Ceph RBD Solution</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cephfs_challenge_solution.html">Ceph CephFS Solution</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_rgw_challenge_solution.html">Ceph RGW Solution</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Ceph Top-Gun Enablement</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Ceph Top-Gun Enablement</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Ceph Top-Gun Enablement</a></li>
    <li>Core Ceph</li>
    <li><a href="ceph_hardware.html">Ceph Hardware Recommendations</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///antora/training/modules/ceph/pages/ceph_hardware.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Hardware recommendations</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Building a Ceph cluster allows you to select various hardware such as the type of CPU, the amount of
RAM, the type and nunber of disk devices as weel as the type and number of network interfaces.</p>
</div>
<div class="paragraph">
<p>What matters when your are designing a cluster is to identify the use case for a given cluster.
Generally speaking the use cases are defined along the following lines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Capacity optimized</p>
</li>
<li>
<p>Throughput optimized</p>
</li>
<li>
<p>IOPS/Latency optimized</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Whatever the use case you are aiming for one thing to always consider is the recovery time
that will be necessary top recover the data in th event of a failure within the cluster.
The common rule to evaluate a good design is that your cluster should be able to recover
from a node failure in a reasonable amount of type, usually 8 hours.</p>
</div>
<div class="paragraph">
<p>This rule will dictate how much capacity will be hosted in each server based ob the network
configuration you have chosen but also the number of nodes present in your cluster.</p>
</div>
<div class="paragraph">
<p>Recovery will leverage 20% of the following 2 metrics</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Surviving cluster media bandwidth</p>
</li>
<li>
<p>Surviving cluster network bandwidth</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To evaluate both metrics, use the following two formulas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>{bandwidth_per_disk} * {devices_per_node} * {surviving_nodes} * 20%</code></p>
</li>
<li>
<p><code>{cluster_bandwidth_per_node} * {surviving_nodes} * 20%</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The lesser of the two calculation will be your recovery speed limit and guide
you to determine how much storage each node can actually carry.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If this limitation does not allow you to recover an entire node in 8 hours,
you will have to make a choice and evaluate if the extended recovery time
does not present too much of a risk for the business.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_capacity_optimized"><a class="anchor" href="#_capacity_optimized"></a>1. Capacity optimized</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Capacity optimized clusters are usually designed for pure object storage use cases such as
document archive, video or audio storage, backup data while not designed for video
streaming. Such cluster is essentially relying on the sequential read and write capabilities
of spindles.</p>
</div>
<div class="paragraph">
<p>The nature of the data and the need to preserve it over a long period of time
is a perfect fit for erasure coding that, through the choice of the correct EC profile,
can increase durability although at the expense of performance.</p>
</div>
<div class="paragraph">
<p>The following elements to consider for such cluster are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All servers have OS on flash devices</p>
</li>
<li>
<p>0.5 core per HDD (assuming a 2 GHz CPU)</p>
</li>
<li>
<p>16GB OS + 5GB per OSD</p>
</li>
<li>
<p>3GB and at least 10GB (recommended 100GB) disk space per Monitor</p>
</li>
<li>
<p>3GB per Manager</p>
</li>
<li>
<p>8GB per RADOS Gateway</p>
</li>
<li>
<p>10GbE for 12 OSDs on both public and cluster networks</p>
</li>
<li>
<p>Deploy 1 OSD per disk device</p>
</li>
<li>
<p>Host bus adapter for device connectivity</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
SMR HDDs devices are not supported by Ceph
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_throughput_optimized"><a class="anchor" href="#_throughput_optimized"></a>2. Throughput optimized</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Throughput optimized clusters are usually designed for application that leverage significantly
large IO requests size  but require a decent amount of eprformance through the use of spindles.
Such application all require the write performance to be at a correct level for data ingestion
while providing data restitution. Those applications can be video streaming, media an
entertainment applications or big data applications such as the creation of data lakes.
In general, such applications leverage block devices or object storage.</p>
</div>
<div class="paragraph">
<p>To guarantee the correct level of performance data protection is implemented
through replicated pools while the presence of flash devices guarantees an optimum
level of performance for BlueStore in combination with spindles to provide the correct
storage density needed.</p>
</div>
<div class="paragraph">
<p>The following elements to consider for such cluster are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All servers have OS on flash devices</p>
</li>
<li>
<p>CPU (assuming a 2 GHz CPU)</p>
<div class="ulist">
<ul>
<li>
<p>1 core per HDD</p>
</li>
<li>
<p>2 cores per non NVMe SSD</p>
</li>
</ul>
</div>
</li>
<li>
<p>16GB OS + 5GB per OSD</p>
</li>
<li>
<p>3GB and at least 10GB (recommended 50GB) disk space per Monitor</p>
</li>
<li>
<p>3GB per Manager</p>
</li>
<li>
<p>8GB and at least 20GB disk space (logging) per RADOS Gateway</p>
</li>
<li>
<p>8GB and at least 20GB disk space (logging) per MDS</p>
</li>
<li>
<p>10GbE for 12 OSDs on both public and cluster networks</p>
</li>
<li>
<p>Deploy 1 OSD per disk device</p>
</li>
<li>
<p>Use flash devices for RocksDB (1% ratio for block only, 4% otherwise)</p>
</li>
<li>
<p>Use space available on flash devices for metadata pools</p>
</li>
<li>
<p>Host bus adapter for device connectivity</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
SMR HDDs devices are not supported by Ceph
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_iops_optimized"><a class="anchor" href="#_iops_optimized"></a>3. IOPS optimized</h2>
<div class="sectionbody">
<div class="paragraph">
<p>IOPS or latency optimized clusters are designed around the PCI bus and the use of
NVMe devices in each node. This type of clusters is appropriate for databae applciations,
SQL or NOSQL, as well as private cloud deployment when virtual machine performance
is a requirement.</p>
</div>
<div class="paragraph">
<p>The NVMe devices, combined with the usage of Ceph, will place a very hight level of
stress on the CPU of each servers.</p>
</div>
<div class="paragraph">
<p>The following elements to consider for such cluster are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All servers have OS on flash devices</p>
</li>
<li>
<p>10 cores per NVMe SSD (assuming a 2 GHz CPU)</p>
</li>
<li>
<p>16GB OS + 10GB per OSD</p>
</li>
<li>
<p>3GB and at least 10GB disk space per Monitor</p>
</li>
<li>
<p>3GB per Manager</p>
</li>
<li>
<p>8GB and at least 20GB disk space (logging) per MDS</p>
</li>
<li>
<p>10GbE for 2 OSDs</p>
</li>
<li>
<p>Only use enterprise grade NVMe flash devices</p>
</li>
<li>
<p>Deploy 2 OSDs per NVMe flash device</p>
</li>
<li>
<p>PCI bus only for device connectivity</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To estimate the number of IOPS that the cluster will be able to deliver, use the following
formula: <code>{num_sockets} * {num_cores} * {GHz} * 1500 = RBD_4K_random_iops</code>
</td>
</tr>
</table>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <a class="navbar-item" href="https://www.redhat.com/en/technologies/cloud-computing/openshift-container-storage" target="_blank">
      <img src="../../_/img/header_logo.svg" alt="Ceph">
  </a>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
