<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RBD Challenge :: Ceph Top Gun Enablement</title>
    <link rel="canonical" href="https://likid0.github.io/ceph-top-gun-enablement/training/ceph/cephrbd_challenge_solution.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.ceph.com/en/latest/" target="_blank">
          <img src="../../_/img/header_logo_reverse.svg" height="48px" alt="Ceph">
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Get Help</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://access.redhat.com/documentation/zh-cn/red_hat_ceph_storage/5" target="_blank">Ceph Documentation</a>
            <a class="navbar-item" href="https://bugzilla.redhat.com/describecomponents.cgi?product=Red%20Hat%20OpenShift%20Container%20Storage" target="_blank">Browse Bugs</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Improve Guides</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/likid0/ceph-top-gun-enablement/issues/new/choose" target="_blank">Open Issue</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Infos</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://www.redhat.com/en/blog/channel/red-hat-storage" target="_blank">Our Blog</a>
            <a class="navbar-item" href="https://www.youtube.com/channel/UCoyG8VyvB-XUxQl1mD3T3Gw" target="_blank">Youtube</a>
            <a class="navbar-item" href="https://docs.ceph.com/en/latest/" target="_blank">Ceph Storage Technology</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="training" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Ceph Top-Gun Enablement</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph Lab Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="opentlc_lab_env.html">Opentlc Lab Env</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Core Ceph</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_introduction.html">Ceph Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_architecture.html">Ceph Architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cluster_partitioning.html">Ceph Cluster Partitioning</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_hardware.html">Ceph Hardware Recommendations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_deployment_intro.html">Ceph Install Methods </a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cephadm_intro.html">Cephadm Orchestrator</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_deploy_basic.html">Deploy Ceph with Cephadm</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_deploy_ui.html">Deploy Ceph from the UI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_dashboard_metrics.html">Ceph Dashboard Management &amp; Metrics</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cli_intro.html">Ceph CLI basic commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_configuration.html">Ceph Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_pools.html">Ceph storage pools config</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_pgs.html">Ceph Health and PGs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_bluestore.html">Ceph OSD Bluestore</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_recovery.html">Ceph OSD Failure/Recovery</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cephx.html">Rados CephX Auth/AuthZ</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_version.html">What version of Ceph am I running?</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph-upgrades_cephadm.html">Upgrade Ceph with Cephadm</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_deployment_challenge.html">Challenge Ceph Deployment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph RADOS Block Device</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephrbd_intro.html">RADOS Block Device introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephrbd_export.html">RBD Import/Export</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephrbd_mirroring.html">RBD Mirroring</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephrbd_challenge.html">Challenge RBD</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">CephFS Shared FileSystem</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephfs_intro.html">CephFS introduction &amp; Deployment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cephfs_advanced.html">CephFS Deep Dive</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cephfs_challenge.html">Challenge Cephfs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph RadosGW</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_intro.html">RGW Introduction &amp; Deployment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_arch_deep_dive.html">RGW Deep Dive</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_ha.html">RGW High Availability</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_ssl.html">RGW &amp; Ingress with SSL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_users_quotas.html">RGW Users &amp; Quotas</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_auth.html">RGW Auth &amp; Authz</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_object_versioning.html">RGW S3 Object Versioning</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_placement_and_storage_classes.html">RGW Placement &amp; Storage Classes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_life_cycle_management.html">RGW Life Cycle Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_bucket_policy.html">RGW S3 Bucket Policy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_sts_introduction.html">RGW Secure Token Service</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_sts_bucket_role_policy.html">RGW Bucket vs Role Policy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_multisite.html">RGW Multisite Replication</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_cloudsync.html">RGW Object Cloud Transition</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_archive.html">RGW Archive Zone</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_presignedurl.html">RGW presigned URL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_opslog.html">RGW Opslog</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="radosgw_bucket_notification.html">RGW bucket Notification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_rgw_challenge.html">Challenge RGW</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="troubleshooting_logging.html">Troubleshooting Logs Debug Mode</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="trouble-shooting-nearfull-osds.html">Troubleshooting nearfull OSDs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="troubleshooting_bluestore.html">Troubleshooting Bluestore issues</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="trouble-shooting-large-omap-objects.html">Troubleshooting Large Omap Objects</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="troubleshooting_break_and_fix.html">Troubleshooting Break &amp; Fix Hands-on</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph Benchmarking</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_performance_example.html">Setting the Inital Baseline</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_performance_fio.html">Benchmarking Ceph block and File</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_performance_object.html">Benchmarking Ceph Object(RGW)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph Stretched</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="rhcs-stretched-deploy.html">Ceph Stretch Mode</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ceph Challenge Solutions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_deployment_challenge_solution.html">Ceph Deployment Solution</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="cephrbd_challenge_solution.html">Ceph RBD Solution</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_cephfs_challenge_solution.html">Ceph CephFS Solution</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ceph_rgw_challenge_solution.html">Ceph RGW Solution</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Ceph Top-Gun Enablement</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Ceph Top-Gun Enablement</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Ceph Top-Gun Enablement</a></li>
    <li>Ceph Challenge Solutions</li>
    <li><a href="cephrbd_challenge_solution.html">Ceph RBD Solution</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///antora/training/modules/ceph/pages/cephrbd_challenge_solution.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">RBD Challenge</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Please try and solve the challenge by yourself only come to this page as a last
resource after fighting with ceph for a while :D</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_rbd_pool"><a class="anchor" href="#_create_rbd_pool"></a>1. Create RBD Pool</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_exercise"><a class="anchor" href="#_exercise"></a>1.1. Exercise</h3>
<div class="paragraph">
<p>Perform the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a pool <code>newrbd</code>  to host some RBDs. The pool will use a replication factor of 2.</p>
</li>
<li>
<p>Change the default RBD Image order to be 20 in  <code>newrbd</code></p>
</li>
<li>
<p>Verify pool <code>rbdpool</code> exists. If not create it</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_solution"><a class="anchor" href="#_solution"></a>1.2. Solution</h3>
<div class="paragraph">
<p>Create the newrbd pool</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># ceph osd pool create newrbd 8 8
# ceph osd pool application enable newrbd rbd
# ceph osd pool set newrbd size 2
# ceph osd pool set newrbd min_size 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Change the Image order to be 20</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># rbd config pool list newrbd | grep rbd_default_order
rbd_default_order                                    22           config
# rbd config pool set newrbd rbd_default_order 20
[root@ceph-node01 ~]# rbd config pool list newrbd | grep rbd_default_order
rbd_default_order                                    20           config</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>rbd_default_order</strong>
This configures the default object size for new images. The value is used as a power of two, meaning default_object_size = 2 ^
rbd_default_order. Configure a value between 12 and 25 (inclusive), translating
to 4KiB lower and 32MiB upper limit.  default value 22 (4MB)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Verify rbdpool exists:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># ceph osd lspools | grep rbdpool
1 rbdpool</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_rbd_image"><a class="anchor" href="#_create_rbd_image"></a>2. Create RBD Image</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_exercise_2"><a class="anchor" href="#_exercise_2"></a>2.1. Exercise</h3>
<div class="paragraph">
<p>Perform the following operations in pool <code>newrbd</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a 256MiB RBD image <code>testimage</code></p>
</li>
<li>
<p>Check used space( # rbd -p rbdpool du newrbd/testimage )</p>
</li>
<li>
<p>Format the RBD Image with <code>ext4</code></p>
</li>
<li>
<p>Copy the content of <code>/var/log</code> into the RBD Image in a directory called <code>batch1</code></p>
</li>
<li>
<p>Create a snapshot <code>snap1</code> for the RBD Image</p>
</li>
<li>
<p>Copy the content of <code>/var/lib/alternatives/</code> into the RBD Image in a directory called <code>batch2</code></p>
</li>
<li>
<p>Create a snapshot <code>snap2</code> for the RBD Image</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_solution_2"><a class="anchor" href="#_solution_2"></a>2.2. Solution</h3>
<div class="paragraph">
<p>Create a 256MiB RBD image <code>testimage</code> and Format the RBD Image with <code>ext4</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># rbd create --pool newrbd --size 256M --image testimage
# rbd -p newrbd info testimage
# rbd -p rbdpool du newrbd/testimage
# rbd map newrbd/testimage
# mkfs.ext4 /dev/rbd0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Rest of the steps to follow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># mount /dev/rbd0 /mnt
# mkdir -p /mnt/batch1
# cp -pr /var/log /mnt/batch1/
# rbd snap create newrbd/testimage@snap1
# mkdir -p /mnt/batch2
# cp -pr /var/lib/alternatives/ /mnt/batch2/
# rbd snap create newrbd/testimage@snap2</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your /mnt/ directory fills up with the data you copy, remember that you can
expand rbd volumes and their underliying FS online</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># rbd resize rbdpool/testimage --size 20G
# resize2fs /dev/rbd0</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_export_and_import"><a class="anchor" href="#_export_and_import"></a>3. Export and Import</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_exercise_3"><a class="anchor" href="#_exercise_3"></a>3.1. Exercise</h3>
<div class="paragraph">
<p>Perform the following operations in pool <code>newrbd</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Export as a flat file the differences between the formatted RBD Image and <code>snap1</code></p>
</li>
<li>
<p>Export as a flat file the differences between <code>snap1</code> and <code>snap2</code></p>
</li>
<li>
<p>Import the differences you exported into a RBD Image named <code>target1</code> in pool <code>rbdpool</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_solution_3"><a class="anchor" href="#_solution_3"></a>3.2. Solution</h3>
<div class="paragraph">
<p>We use the <code>rbd export-diff</code> command to output to file the differences between
the current image state and snap1</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">#  rbd export-diff newrbd/testimage@snap1 /tmp/diffsnap1.rbd
Exporting image: 100% complete...done.</code></pre>
</div>
</div>
<div class="paragraph">
<p>We do the same and capture the differences between snap1 and snap2 into file /tmp/diffsnap1tosnap2.rbd</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># rbd export-diff --from-snap snap1 newrbd/testimage@snap2 /tmp/diffsnap1tosnap2.rbd
Exporting image: 100% complete...done.</code></pre>
</div>
</div>
<div class="paragraph">
<p>With both export files we have a full picture of the state of our image, so we
can merge the exports in a single file with <code>rbd merge-diff</code> called
<code>/tmp/final.rbd</code> and import the image into the <code>rbdpool</code> pool</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># rbd merge-diff /tmp/diffsnap1.rbd /tmp/diffsnap1tosnap2.rbd /tmp/final.rbd
Merging image diff: 100% complete...done.
# rbd import /tmp/final.rbd rbdpool/target1
Importing image: 100% complete...done.</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_clone"><a class="anchor" href="#_clone"></a>4. Clone</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_exercise_4"><a class="anchor" href="#_exercise_4"></a>4.1. Exercise</h3>
<div class="paragraph">
<p>Perform the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a clone of <code>newrbd/testimage@snap2</code> in pool <code>rbdpool</code> and name it <code>clone1</code></p>
</li>
<li>
<p>Make the clone rbdpool/clone1 an independent RBD Image</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_solution_4"><a class="anchor" href="#_solution_4"></a>4.2. Solution</h3>
<div class="paragraph">
<p>Before we can clone an RBD snap we need to protect it, so it can&#8217;t be deleted</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># rbd snap protect newrbd/testimage@snap2
# rbd clone newrbd/testimage@snap2 rbdpool/clone1</code></pre>
</div>
</div>
<div class="paragraph">
<p>We are goig to <code>Flaten</code> the clone so it&#8217;s and independent RBD image in pool
<code>rbdpool</code> we will see that after we flaten the clone it will consume the full
space of the image not only the COW space.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># rbd du rbdpool/clone1
# rbd flatten rbdpool/clone1
Image flatten: 100% complete...done.
# rbd du rbdpool/clone1</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cleanup"><a class="anchor" href="#_cleanup"></a>5. Cleanup</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Delete all RBD Images</p>
</li>
<li>
<p>Delete all pools you have created</p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <a class="navbar-item" href="https://www.redhat.com/en/technologies/cloud-computing/openshift-container-storage" target="_blank">
      <img src="../../_/img/header_logo.svg" alt="Ceph">
  </a>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
